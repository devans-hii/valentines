<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>BE MY VALENTINE</title>
  <style>
    body {
      background: #ffe6ee;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      text-align: center;
      padding-top: 60px;
    }

    h1 {
      color: #b30047;
      margin-bottom: 30px;
      text-shadow: 0 0 10px rgba(0,0,0,0.2);
    }

    .scene {
      position: relative;
      width: 360px;
      height: 380px;
      margin: auto;
    }

    /* Heart */
    .heart {
      width: 170px;
      height: 150px;
      background: crimson;
      position: absolute;
      left: 50%;
      top: 20px;
      transform: translateX(-50%) rotate(-45deg);
      border-radius: 10px;
      transition: transform 0.6s ease;
      overflow: hidden;
    }

    .heart::before,
    .heart::after {
      content: "";
      width: 170px;
      height: 150px;
      background: crimson;
      border-radius: 50%;
      position: absolute;
    }

    .heart::before { top: -80px; left: 0; }
    .heart::after { left: 80px; top: 0; }

    .heart.open {
      transform: translateX(-50%) rotate(-45deg) scale(1.05);
    }

    /* Image & message inside heart */
    .inside {
      position: absolute;
      inset: 0;
      transform: rotate(45deg);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transition: opacity 0.7s ease;
      padding: 10px;
      color: white;
    }

    .heart.open .inside {
      opacity: 1;
    }

    .inside img {
      width: 100%;
      height: 70%;
      object-fit: cover;
      border-radius: 10px;
      margin-bottom: 8px;
    }

    .inside .text {
      font-weight: 700;
      font-size: 16px;
      text-shadow: 0 0 8px rgba(0,0,0,0.4);
    }

    /* Lock */
    .lock {
      font-size: 42px;
      position: absolute;
      left: 50%;
      top: 190px;
      transform: translateX(-50%);
      transition: filter 0.2s ease, transform 0.2s ease;
    }

    .lock.glow {
      filter: drop-shadow(0 0 18px rgba(255, 61, 110, 0.8));
    }

    .lock.open {
      transform: translateX(-50%) rotate(25deg);
    }

    /* Key */
    .key {
      font-size: 42px;
      cursor: grab;
      user-select: none;
      position: absolute;
      left: 50%;
      top: 260px;
      transform: translateX(-50%);
      transition: transform 0.2s ease;
    }

    .key:hover { transform: translateX(-50%) scale(1.1); }

    /* Confetti */
    .confetti {
      position: absolute;
      inset: 0;
      pointer-events: none;
      overflow: hidden;
      display: none;
    }

    .confetti.active { display: block; }

    .confetti-piece {
      position: absolute;
      width: 8px;
      height: 12px;
      background: #ff3d6e;
      animation: fall 1.4s linear infinite;
    }

    @keyframes fall {
      0% { transform: translateY(-50px); opacity: 1; }
      100% { transform: translateY(300px); opacity: 0; }
    }
  </style>
</head>
<body>

  <h1>You hold the key to my heart üóùÔ∏è</h1>

  <div class="scene">
    <div class="heart" id="heart">
      <div class="inside">
        <img src="hehe.jpg" alt="hehe">
        <div class="text">Will you be my Valentine? üíò</div>
      </div>
    </div>

    <div class="lock" id="lock">üîí</div>
    <div class="key" id="key">üóùÔ∏è</div>

    <div class="confetti" id="confetti"></div>
  </div>

  <audio id="song" src="english.mp3"></audio>

  <script>
    const key = document.getElementById("key");
    const lock = document.getElementById("lock");
    const heart = document.getElementById("heart");
    const song = document.getElementById("song");
    const confetti = document.getElementById("confetti");

    let unlocked = false;
    let dragging = false;
    let offsetX = 0;
    let offsetY = 0;

    const startX = key.offsetLeft;
    const startY = key.offsetTop;

    key.addEventListener("pointerdown", (e) => {
      dragging = true;
      key.setPointerCapture(e.pointerId);
      offsetX = e.clientX - key.getBoundingClientRect().left;
      offsetY = e.clientY - key.getBoundingClientRect().top;
    });

    key.addEventListener("pointermove", (e) => {
      if (!dragging || unlocked) return;

      key.style.left = `${e.clientX - offsetX}px`;
      key.style.top = `${e.clientY - offsetY}px`;

      const distance = getDistance(getCenter(key), getCenter(lock));

      // Glow if close
      if (distance < 150) lock.classList.add("glow");
      else lock.classList.remove("glow");

      // Unlock when close enough
      if (distance < 60) unlock();
    });

    key.addEventListener("pointerup", () => {
      dragging = false;
      if (!unlocked) {
        key.style.left = `${startX}px`;
        key.style.top = `${startY}px`;
      }
    });

    function unlock() {
      unlocked = true;
      lock.classList.remove("glow");
      lock.classList.add("open");
      heart.classList.add("open");

      // Snap key into lock perfectly
      const lockRect = lock.getBoundingClientRect();
      const sceneRect = document.querySelector(".scene").getBoundingClientRect();
      const keyWidth = key.offsetWidth;
      const keyHeight = key.offsetHeight;

      key.style.left = `${lockRect.left - sceneRect.left + (lockRect.width/2) - (keyWidth/2)}px`;
      key.style.top = `${lockRect.top - sceneRect.top + (lockRect.height/2) - (keyHeight/2)}px`;
      key.style.transform = "translateX(-50%) rotate(90deg)";

      song.play();
      startConfetti();
    }

    function getCenter(el) {
      const r = el.getBoundingClientRect();
      return { x: r.left + r.width / 2, y: r.top + r.height / 2 };
    }

    function getDistance(a, b) {
      return Math.hypot(a.x - b.x, a.y - b.y);
    }

    function startConfetti() {
      confetti.classList.add("active");
      for (let i = 0; i < 25; i++) {
        const piece = document.createElement("div");
        piece.classList.add("confetti-piece");
        piece.style.left = Math.random() * 100 + "%";
        piece.style.background = `hsl(${Math.random() * 360}, 90%, 65%)`;
        piece.style.animationDelay = `${Math.random() * 1.4}s`;
        confetti.appendChild(piece);
      }
    }
  </script>
</body>
</html>
