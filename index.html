<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>BE MY VALENTINE</title>
  <style>
    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      overflow: hidden;
      background: url("bg.jpg") center/cover no-repeat fixed;
    }

    h1 {
      color: #ffffff;
      text-align: center;
      margin-top: 30px;
      text-shadow: 0 0 10px rgba(0,0,0,0.7);
    }

    .scene {
      position: relative;
      width: 360px;
      height: 420px;
      margin: auto;
      margin-top: 20px;
    }

    /* PERFECT SMOOTH HEART (üß°) */
    .heart {
      width: 120px;
      height: 120px;
      background: #ff6b6b;
      position: absolute;
      left: 50%;
      top: 30px;
      transform: translateX(-50%);
      transition: transform 0.6s ease;
    }

    .heart::before,
    .heart::after {
      content: "";
      width: 120px;
      height: 120px;
      background: #ff6b6b;
      border-radius: 50%;
      position: absolute;
    }

    .heart::before {
      top: -60px;
      left: 0;
    }

    .heart::after {
      left: 60px;
      top: 0;
    }

    .heart.open {
      transform: translateX(-50%) scale(1.05);
    }

    .heart-text {
      position: absolute;
      left: 50%;
      top: 30px;
      width: 120px;
      height: 120px;
      transform: translateX(-50%) 
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      font-weight: 800;
      color: white;
      text-shadow: 0 0 8px rgba(0,0,0,0.6);
      opacity: 0;
      transition: opacity 0.8s ease;
      text-align: center;
      padding: 10px;
    }

    .heart.open .heart-text {
      opacity: 1;
    }

    .lock {
      font-size: 42px;
      position: absolute;
      left: 50%;
      top: 220px;
      transform: translateX(-50%);
      transition: filter 0.2s ease, transform 0.2s ease;
    }

    .lock.glow {
      filter: drop-shadow(0 0 18px rgba(255, 61, 110, 0.8));
    }

    .lock.open {
      transform: translateX(-50%);
    }

    .key {
      font-size: 42px;
      cursor: grab;
      user-select: none;
      position: absolute;
      left: 50%;
      top: 290px;
      transform: translateX(-50%);
      transition: transform 0.2s ease;
      touch-action: none;
    }

    .key:hover { transform: translateX(-50%) scale(1.1); }

    .confetti {
      position: fixed;
      inset: 0;
      pointer-events: none;
      overflow: hidden;
      display: none;
      z-index: 999;
    }

    .confetti.active {
      display: block;
    }

    .confetti-piece {
      position: absolute;
      width: 10px;
      height: 14px;
      background: #ff3d6e;
      animation: fall 1.6s linear infinite;
    }

    @keyframes fall {
      0% { transform: translateY(-50px) rotate(0deg); opacity: 1; }
      100% { transform: translateY(800px) rotate(360deg); opacity: 0; }
    }
  </style>
</head>
<body>

  <h1>You hold the key to my heart üóùÔ∏è</h1>

  <div class="scene">
    <div class="heart" id="heart">
      <div class="heart-text">Will u be my Valentine? üíò</div>
    </div>

    <div class="lock" id="lock">üîí</div>
    <div class="key" id="key">üóùÔ∏è</div>
  </div>

  <div class="confetti" id="confetti"></div>

  <audio id="song" src="english.mp3"></audio>

  <script>
    const key = document.getElementById("key");
    const lock = document.getElementById("lock");
    const heart = document.getElementById("heart");
    const song = document.getElementById("song");
    const confetti = document.getElementById("confetti");

    let unlocked = false;
    let dragging = false;
    let offsetX = 0;
    let offsetY = 0;

    const startX = key.offsetLeft;
    const startY = key.offsetTop;

    key.addEventListener("pointerdown", (e) => {
      dragging = true;
      key.setPointerCapture(e.pointerId);
      offsetX = e.clientX - key.getBoundingClientRect().left;
      offsetY = e.clientY - key.getBoundingClientRect().top;
    });

    key.addEventListener("pointermove", (e) => {
      if (!dragging || unlocked) return;

      key.style.left = `${e.clientX - offsetX}px`;
      key.style.top = `${e.clientY - offsetY}px`;

      const distance = getDistance(getCenter(key), getCenter(lock));

      if (distance < 150) lock.classList.add("glow");
      else lock.classList.remove("glow");

      if (distance < 60) unlock();
    });

    key.addEventListener("pointerup", () => {
      dragging = false;
      if (!unlocked) {
        key.style.left = `${startX}px`;
        key.style.top = `${startY}px`;
      }
    });

    function unlock() {
      unlocked = true;
      lock.classList.remove("glow");
      lock.classList.add("open");
      heart.classList.add("open");

      const lockRect = lock.getBoundingClientRect();
      const sceneRect = document.querySelector(".scene").getBoundingClientRect();
      const keyWidth = key.offsetWidth;
      const keyHeight = key.offsetHeight;

      key.style.left = `${lockRect.left - sceneRect.left + (lockRect.width/2) - (keyWidth/2)}px`;
      key.style.top = `${lockRect.top - sceneRect.top + (lockRect.height/2) - (keyHeight/2)}px`;
      key.style.transform = "translateX(-50%) rotate(90deg)";

      song.play();
      startConfetti();
    }

    function getCenter(el) {
      const r = el.getBoundingClientRect();
      return { x: r.left + r.width / 2, y: r.top + r.height / 2 };
    }

    function getDistance(a, b) {
      return Math.hypot(a.x - b.x, a.y - b.y);
    }

    function startConfetti() {
      confetti.classList.add("active");
      for (let i = 0; i < 80; i++) {
        const piece = document.createElement("div");
        piece.classList.add("confetti-piece");
        piece.style.left = Math.random() * 100 + "%";
        piece.style.top = Math.random() * -20 + "vh";
        piece.style.background = `hsl(${Math.random() * 360}, 90%, 65%)`;
        piece.style.animationDelay = `${Math.random() * 1.6}s`;
        piece.style.animationDuration = `${1.6 + Math.random()}s`;
        confetti.appendChild(piece);
      }
    }
  </script>
</body>
</html>
